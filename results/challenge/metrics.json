{
  "model": "PhysMDT",
  "config": {
    "d_model": 64,
    "n_heads": 4,
    "n_layers": 4,
    "d_ff": 256,
    "max_seq_len": 48,
    "refinement_K": 10,
    "seed": 42
  },
  "n_challenge_equations": 20,
  "n_from_generator": 15,
  "n_custom_kepler_lagrangian": 5,
  "aggregate_metrics": {
    "exact_match": 0.0,
    "symbolic_equivalence": 0.0,
    "numerical_r2": 0.0,
    "tree_edit_distance": 0.8659574468085107,
    "complexity_penalty": 0.7908333333333333,
    "composite_score": 2.3862588652482275
  },
  "symbolic_equivalence_rate": 0.0,
  "per_family": {
    "dynamics": {
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.8085106382978723,
      "complexity_penalty": 1.0,
      "composite_score": 1.9148936170212774
    },
    "energy": {
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.7872340425531915,
      "complexity_penalty": 0.25,
      "composite_score": 5.877659574468085
    },
    "fluid_statics": {
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.9219858156028368,
      "complexity_penalty": 1.0,
      "composite_score": 0.7801418439716312
    },
    "gravitation": {
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.8776595744680851,
      "complexity_penalty": 0.70625,
      "composite_score": 2.6921542553191493
    },
    "oscillations": {
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.8680851063829786,
      "complexity_penalty": 0.9333333333333332,
      "composite_score": 1.6524822695035468
    }
  },
  "per_equation_results": [
    {
      "template_name": "torricelli",
      "family": "fluid_statics",
      "difficulty": "complex",
      "infix_readable": "v = sqrt(2*g*h)",
      "gt_prefix": "sqrt mul INT_2 mul g_accel h",
      "predicted_prefix": "add add add add h sqrt P_pressure add add pi pi mul add add add add h pi P_pressure P_pressure add add h sqrt add P_pressure add add h pi pi P_pressure add add add h add add P_pressure add add h pi sqrt add add add",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.9361702127659575,
      "complexity_penalty": 1.0,
      "composite_score": 0.6382978723404255
    },
    {
      "template_name": "spring_period",
      "family": "oscillations",
      "difficulty": "complex",
      "infix_readable": "T = 2*pi*sqrt(m/k)",
      "gt_prefix": "mul mul INT_2 pi sqrt div m k_spring",
      "predicted_prefix": "add add div INT_1 pow pow pow mul INT_1 INT_2 mul mul mul add add div INT_1 pi sub mul div div INT_1 mul sub add add add INT_1 pi pi mul mul add div INT_1 sub add add div div INT_1 INT_2 mul mul add div",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.9148936170212766,
      "complexity_penalty": 1.0,
      "composite_score": 0.8510638297872343
    },
    {
      "template_name": "kepler_3rd_simple",
      "family": "gravitation",
      "difficulty": "complex",
      "infix_readable": "T^2 = (4pi^2/(GM))*r^3",
      "gt_prefix": "div pow r INT_3 pow mul div INT_1 mul INT_2 pi mul G_const m INT_1 INT_2",
      "predicted_prefix": "G_const pow pow INT_3 INT_3 INT_3 pow pow INT_3 INT_3 pi mul G_const m pow r INT_3 INT_3 pow pow pow r INT_3 pi pow m pow pow INT_3 pi pi mul pow pow INT_3 INT_3 INT_3 m pow pow INT_3 INT_3 pi pow pow pow pow",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.851063829787234,
      "complexity_penalty": 0.2,
      "composite_score": 5.489361702127661
    },
    {
      "template_name": "bernoulli_simple",
      "family": "fluid_statics",
      "difficulty": "complex",
      "infix_readable": "P + 0.5*rho*v^2 + rho*g*h",
      "gt_prefix": "add P_pressure add mul div INT_1 INT_2 mul rho pow v INT_2 mul rho mul g_accel h",
      "predicted_prefix": "P_pressure add add add pow P_pressure P_pressure P_pressure add pow pow mul P_pressure P_pressure add add pow pow P_pressure P_pressure add add pow pow P_pressure P_pressure P_pressure add pow pow pow P_pressure P_pressure add add add add P_pressure P_pressure add add pow pow P_pressure P_pressure P_pressure add",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.8936170212765957,
      "complexity_penalty": 1.0,
      "composite_score": 1.063829787234043
    },
    {
      "template_name": "torricelli",
      "family": "fluid_statics",
      "difficulty": "complex",
      "infix_readable": "v = sqrt(2*g*h)",
      "gt_prefix": "sqrt mul INT_2 mul g_accel h",
      "predicted_prefix": "add add add add h sqrt sqrt add add pi pi mul add add add add h pi sqrt P_pressure add add h pi add P_pressure add add h pi pi P_pressure add add add h add add P_pressure add div h pi pi add add add",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.9361702127659575,
      "complexity_penalty": 1.0,
      "composite_score": 0.6382978723404255
    },
    {
      "template_name": "spring_period",
      "family": "oscillations",
      "difficulty": "complex",
      "infix_readable": "T = 2*pi*sqrt(m/k)",
      "gt_prefix": "mul mul INT_2 pi sqrt div m k_spring",
      "predicted_prefix": "add add div INT_1 pow pow pow mul INT_1 INT_2 mul mul mul add add div INT_1 pi sub mul div div INT_1 mul sub add add add INT_1 pi pi mul mul add div INT_1 sub add add div div INT_1 INT_2 mul mul add div",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.9148936170212766,
      "complexity_penalty": 1.0,
      "composite_score": 0.8510638297872343
    },
    {
      "template_name": "orbital_velocity",
      "family": "gravitation",
      "difficulty": "complex",
      "infix_readable": "v = sqrt(G*M/r)",
      "gt_prefix": "sqrt div mul G_const m r",
      "predicted_prefix": "add add div INT_1 pow pow pow mul INT_1 INT_2 mul mul mul add add div INT_1 pi sub mul div div INT_1 mul sub add add add INT_1 pi pi mul mul add div INT_1 sub add add div div INT_1 INT_2 mul mul add div",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.9574468085106383,
      "complexity_penalty": 1.0,
      "composite_score": 0.4255319148936165
    },
    {
      "template_name": "energy_conservation",
      "family": "energy",
      "difficulty": "complex",
      "infix_readable": "E = 0.5*m*v^2 + m*g*h",
      "gt_prefix": "add mul div INT_1 INT_2 mul m pow v INT_2 mul m mul g_accel h",
      "predicted_prefix": "m m div INT_1 pow pow pow pow INT_1 INT_2 INT_2 mul m m m div INT_1 pow pow m div div INT_1 mul m m m div INT_2 INT_2 mul mul m div div INT_2 m m m div div INT_2 INT_2 mul m m div",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.7872340425531915,
      "complexity_penalty": 0.5,
      "composite_score": 4.627659574468085
    },
    {
      "template_name": "drag_force",
      "family": "dynamics",
      "difficulty": "complex",
      "infix_readable": "F_d = 0.5*rho*A*v^2*Cd",
      "gt_prefix": "mul mul div INT_1 INT_2 mul rho mul A_area pow v INT_2 mul INT_1 INT_1",
      "predicted_prefix": "add add div INT_1 pow pow pow mul INT_1 INT_2 mul mul mul add add div INT_1 pi sub mul div div INT_1 mul sub add add add INT_1 pi pi mul mul add div INT_1 sub add add div div INT_1 INT_2 mul mul add div",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.8085106382978723,
      "complexity_penalty": 1.0,
      "composite_score": 1.9148936170212774
    },
    {
      "template_name": "kepler_3rd_simple",
      "family": "gravitation",
      "difficulty": "complex",
      "infix_readable": "T^2 = (4pi^2/(GM))*r^3",
      "gt_prefix": "div pow r INT_3 pow mul div INT_1 mul INT_2 pi mul G_const m INT_1 INT_2",
      "predicted_prefix": "G_const pow pow INT_3 INT_3 INT_3 pow pow INT_3 INT_3 pi mul G_const m pow r INT_3 INT_3 pow pow pow r INT_3 pi pow m pow pow INT_3 pi pi mul pow pow INT_3 INT_3 INT_3 m pow pow INT_3 INT_3 pi pow pow pow pow",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.851063829787234,
      "complexity_penalty": 0.2,
      "composite_score": 5.489361702127661
    },
    {
      "template_name": "orbital_period",
      "family": "gravitation",
      "difficulty": "complex",
      "infix_readable": "T = 2*pi*sqrt(r^3/(G*M))",
      "gt_prefix": "mul mul INT_2 pi sqrt div pow r INT_3 mul G_const m",
      "predicted_prefix": "G_const pow pow INT_3 INT_3 INT_3 pow pow INT_3 INT_3 pi mul G_const m pow r INT_3 INT_3 pow pow pow INT_3 INT_3 pi pow m pow INT_3 INT_3 pi pi pi pow pow INT_3 INT_3 INT_3 m m pow INT_3 INT_3 pi pi div pow pow",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.8936170212765957,
      "complexity_penalty": 0.25,
      "composite_score": 4.813829787234043
    },
    {
      "template_name": "tidal_force",
      "family": "gravitation",
      "difficulty": "complex",
      "infix_readable": "F_tidal = 2*G*M*d/r^3",
      "gt_prefix": "mul INT_2 div mul G_const mul m d pow r INT_3",
      "predicted_prefix": "add add div INT_1 pow pow pow mul INT_1 INT_2 mul mul mul add add div INT_1 pi sub mul div div INT_1 mul sub add add add INT_1 pi pi mul mul add div INT_1 sub add add div div INT_1 INT_2 mul mul add div",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.8936170212765957,
      "complexity_penalty": 1.0,
      "composite_score": 1.063829787234043
    },
    {
      "template_name": "damped_oscillation",
      "family": "oscillations",
      "difficulty": "complex",
      "infix_readable": "x = A*exp(-mu*t/(2m))*sin(omega*t)",
      "gt_prefix": "mul mul A_area exp neg mul mul div INT_1 INT_2 mul mu div t m sin mul omega t",
      "predicted_prefix": "rho A_area A_area exp INT_3 mul mul mul exp exp mul mul mul mul A_area A_area exp INT_3 mul mul A_area A_area exp mul mul rho mul exp exp mul mul mul mul A_area A_area mul mul m mul A_area exp exp mul mul mul mul A_area",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.8085106382978723,
      "complexity_penalty": 1.0,
      "composite_score": 1.9148936170212774
    },
    {
      "template_name": "energy_conservation",
      "family": "energy",
      "difficulty": "complex",
      "infix_readable": "E = 0.5*m*v^2 + m*g*h",
      "gt_prefix": "add mul div INT_1 INT_2 mul m pow v INT_2 mul m mul g_accel h",
      "predicted_prefix": "m m div INT_1 INT_2 pow pow mul INT_1 INT_2 INT_2 mul m m add div INT_1 pow m m div div INT_1 mul m m m div INT_2 INT_2 mul mul m div div INT_2 m m m div div INT_2 INT_2 mul m m div",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.7872340425531915,
      "complexity_penalty": 0.0,
      "composite_score": 7.127659574468086
    },
    {
      "template_name": "drag_force",
      "family": "dynamics",
      "difficulty": "complex",
      "infix_readable": "F_d = 0.5*rho*A*v^2*Cd",
      "gt_prefix": "mul mul div INT_1 INT_2 mul rho mul A_area pow v INT_2 mul INT_1 INT_1",
      "predicted_prefix": "add add div INT_1 pow pow pow mul INT_1 INT_2 mul mul mul add add div INT_1 pi sub mul div div INT_1 mul sub add add add INT_1 pi pi mul mul add div INT_1 sub add add div div INT_1 INT_2 mul mul add div",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.8085106382978723,
      "complexity_penalty": 1.0,
      "composite_score": 1.9148936170212774
    },
    {
      "template_name": "kepler_third_law_full",
      "family": "gravitation",
      "difficulty": "complex",
      "infix_readable": "T^2 = (4*pi^2/(G*M)) * r^3",
      "gt_prefix": "mul div mul INT_4 pow pi INT_2 mul G_const m pow r INT_3",
      "predicted_prefix": "m m div INT_1 pow pow pow pow pow INT_2 mul mul m m m div INT_3 pow pow pow div div INT_3 pow m m pow pow INT_3 pow pow m m m div pow m m m div INT_1 INT_3 pow pow m m div",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.851063829787234,
      "complexity_penalty": 1.0,
      "composite_score": 1.4893617021276597
    },
    {
      "template_name": "vis_viva_equation",
      "family": "gravitation",
      "difficulty": "complex",
      "infix_readable": "v^2 = G*M*(2/r - 1/a)",
      "gt_prefix": "mul G_const mul m sub div INT_2 r div INT_1 a",
      "predicted_prefix": "m m div INT_1 pow pow pow mul INT_1 INT_2 mul mul m m div div INT_1 pow pow m div div INT_1 mul m m m div INT_1 INT_2 mul mul mul div div INT_1 m m m div div INT_1 INT_2 mul m m div",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.851063829787234,
      "complexity_penalty": 1.0,
      "composite_score": 1.4893617021276597
    },
    {
      "template_name": "lagrangian_pendulum",
      "family": "oscillations",
      "difficulty": "complex",
      "infix_readable": "L = 0.5*m*l^2*omega^2 - m*g*l*(1-cos(theta))",
      "gt_prefix": "sub mul div INT_1 INT_2 mul m mul pow l_length INT_2 pow omega INT_2 mul m mul g_accel mul l_length sub INT_1 cos theta",
      "predicted_prefix": "m m div div pow pow pow mul div INT_2 INT_2 mul m m m div t pow pow m div div t pow m m m div t pow mul m m m div t m m m div div t INT_2 m m m div",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.8085106382978723,
      "complexity_penalty": 0.6666666666666666,
      "composite_score": 3.5815602836879443
    },
    {
      "template_name": "kepler_orbit_equation",
      "family": "gravitation",
      "difficulty": "complex",
      "infix_readable": "r = a*(1-e^2)/(1+e*cos(theta))",
      "gt_prefix": "div mul a sub INT_1 pow mu INT_2 add INT_1 mul mu cos theta",
      "predicted_prefix": "add add add div pow pow pow mul add INT_2 INT_2 mul add add add div INT_2 pow add P_pressure add div INT_1 mul add add add add INT_2 INT_2 mul mul mul add div INT_2 add add P_pressure add div INT_2 INT_2 mul m add add",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.8723404255319149,
      "complexity_penalty": 1.0,
      "composite_score": 1.276595744680851
    },
    {
      "template_name": "coupled_oscillator_freq",
      "family": "oscillations",
      "difficulty": "complex",
      "infix_readable": "omega^2 = k/m + 2*k_c/m",
      "gt_prefix": "add div k_spring m div mul INT_2 mu m",
      "predicted_prefix": "add add div INT_1 pow pow pow mul INT_1 INT_2 mul mul mul add add div INT_1 pi sub mul div div INT_1 mul sub add add add INT_1 pi pi mul mul add div INT_1 sub add add div div INT_1 INT_2 mul mul add div",
      "exact_match": 0.0,
      "symbolic_equivalence": 0.0,
      "numerical_r2": 0.0,
      "tree_edit_distance": 0.8936170212765957,
      "complexity_penalty": 1.0,
      "composite_score": 1.063829787234043
    }
  ]
}